<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link rel="stylesheet" href="dist/output.css" />
  </head>
  <body>
    <div class="w-[60%] mx-auto mt-7">
      <div>
        <input
          type="text"
          name="search"
          id="searchBox"
          class="border border-stone-800 rounded-md p-1"
        />
        <button
          id="searchButton"
          onclick="search()"
          class="bg-teal-500 text-white mx-auto rounded-lg text-lg w-[20%] p-1 hover:bg-teal-600"
        >
          search
        </button>
        <span id="sallary" class="font-semibold"></span>
        <p id="searchResult" class="font-semibold"></p>
      </div>

      <div
        class="border p-10 mt-4 leading-8 border-teal-900 border-2 rounded-md"
      >
        <div id="info"></div>
      </div>
    </div>

    <script>
      let flag = true;
      let str = "";
      let baseSallary;
      let hourlySallary;
      let pos;
      let info = document.querySelector("#info").innerHTML;
      const searchInput = document.querySelector("#searchBox");
      let xmlData = [];

      const getXMl = async () => {
        const response = await fetch("./xmlFile.xml");
        let data = await response.text();
        console.log(data);
        data = data.split(" ");
        for (let i = 0; i < data.length; i++) {
          str += data[i];
          document.querySelector("#info").innerHTML = str;
        }
        info = document.querySelector("#info").innerHTML;
        xmlData.push(data);

        calcSallary();
      };

      const calcSallary = () => {
        xmlData.map((item, index) => {
          pos = item[4];
          console.log(pos);
          if (JSON.stringify(xmlData[index]).includes("basic")) {
            if (pos.includes("front")) {
              baseSallary = 900;
              xmlData.push({sallary : baseSallary * 40});
              console.log(xmlData);
              document.querySelector("#sallary").innerHTML = JSON.stringify(`Sallary : ${xmlData[1].sallary}`);
              console.log(xmlData[1]);
            } else if (pos.includes("back")) {
              baseSallary = 1000;
              xmlData.push({sallary : baseSallary * 40});
              console.log(xmlData);
              document.querySelector("#sallary").innerHTML = JSON.stringify(`Sallary : ${xmlData[1].sallary}`);
              console.log(xmlData[1]);
            } else if (pos.includes("strategist")) {
              baseSallary = 700;
              xmlData.push({sallary : baseSallary * 40});
              console.log(xmlData);
              document.querySelector("#sallary").innerHTML = JSON.stringify(`Sallary : ${xmlData[1].sallary}`);
              console.log(xmlData[1]);
            } else {
              baseSallary = 700;
              xmlData.push({sallary : baseSallary * 40});
              console.log(xmlData);
              document.querySelector("#sallary").innerHTML = JSON.stringify(`Sallary : ${xmlData[1].sallary}`);
              console.log(xmlData[1]);
            }
          } else {
            if (pos.includes("front")) {
              hourlySallary = 800;
              xmlData.push({sallary : hourlySallary * 40});
              console.log(xmlData);
              document.querySelector("#sallary").innerHTML = JSON.stringify(`Sallary : ${xmlData[1].sallary}`);
              console.log(xmlData[1]);
            } else if (pos.includes("back")) {
              hourlySallary = 900;
              xmlData.push({sallary : hourlySallary * 40});
              console.log(xmlData);
              document.querySelector("#sallary").innerHTML = JSON.stringify(`Sallary : ${xmlData[1].sallary}`);
              console.log(xmlData[1]);
            } else if (pos.includes("strategist")) {
              hourlySallary = 600;
              xmlData.push({sallary : hourlySallary * 40});
              console.log(xmlData);
              document.querySelector("#sallary").innerHTML = JSON.stringify(`Sallary : ${xmlData[1].sallary}`);
              console.log(xmlData[1]);
            } else {
              hourlySallary = 600;
              xmlData.push({sallary : hourlySallary * 40});
              console.log(xmlData);
              document.querySelector("#sallary").innerHTML = JSON.stringify(`Sallary : ${xmlData[1].sallary}`);
              console.log(xmlData[1]);
            }
          }
        });
      };

      const search = () => {
        for (let i = 0; i < xmlData.length; i++) {
          // console.log(searchInput.value);
          if (JSON.stringify(xmlData[i]).includes(searchInput.value)) {
            // for(let k = 0; k < xmlData.length ; k++){
            //   xmlData.map(item => {
            //     console.log(item);
            //   })
            // }
            document.querySelector("#searchResult").innerHTML =
              searchInput.value;
          } else {
            document.querySelector(
              "#searchResult"
            ).innerHTML = `<span class="text-red-700">Not Found</span>`;
          }
        }
      };

      if (flag) {
        getXMl();
        flag = false;
      }
    </script>
  </body>
</html>
